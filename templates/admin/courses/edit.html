{% extends "base.html" %}
{% block content %}

<h2>Edit Course</h2>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-danger">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<form method="post">
    {% csrf_token %}

    <!-- Course Name -->
    <div class="mb-3">
        <label class="form-label">Course Name</label>
        <input
            type="text"
            name="name"
            value="{{ course.name }}"
            class="form-control"
            required
        >
    </div>

    <!-- Course Code -->
    <div class="mb-3">
        <label class="form-label">Course Code</label>
        <input
            type="text"
            name="code"
            value="{{ course.code }}"
            class="form-control"
            required
        >
    </div>

    <!-- Total Lectures -->
    <div class="mb-3">
        <label class="form-label">Total Lectures</label>
        <input
            type="number"
            name="total_lectures"
            value="{{ course.total_lectures }}"
            class="form-control"
            min="1"
            required
        >
    </div>

    <!-- Assign Teacher -->
    <div class="mb-3">
        <label class="form-label">Assign Teacher</label>
        <select name="teacher" class="form-control">
            <option value="">-- Select Teacher --</option>
            {% for teacher in teachers %}
                <option value="{{ teacher.id }}"
                    {% if course.teacher and course.teacher.id == teacher.id %}
                        selected
                    {% endif %}
                >
                    {{ teacher.user.first_name }} {{ teacher.user.last_name }}
                </option>
            {% endfor %}
        </select>
    </div>

    <!-- Enroll Students (MULTIPLE) -->
    <div class="mb-3">
        <label class="form-label">Enroll Students</label>
        <select
            name="students"
            class="form-control"
            multiple
            size="6"
        >
            {% for student in students %}
                <option value="{{ student.id }}"
                    {% if student in course.students.all %}
                        selected
                    {% endif %}
                >
                    {{ student.user.first_name }}
                    {{ student.user.last_name }}
                    ({{ student.roll_no }})
                </option>
            {% endfor %}
        </select>
        <small class="text-muted">
            Hold <b>CTRL</b> (Windows/Linux) or <b>CMD</b> (Mac) to select multiple students
        </small>
    </div>

    <!-- Submit -->
    <button type="submit" class="btn btn-success">
        Update Course
    </button>

</form>

{% endblock %}
